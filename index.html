<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <style>
        html { font-family: 'Inter', sans-serif; }

        body {
            height: 100vh;
            margin: 0;
            display: flex;
            flex-direction: column;
            overflow: hidden; 
            background-color: #f7f7f7;
        }

        .content-container {
            flex-grow: 1;
            padding-bottom: 80px; 
            overflow-y: auto; 
            -webkit-overflow-scrolling: touch; 
        }

        .iframe-container {
            height: 100%;
            width: 100%;
            overflow: hidden;
        }

        .iframe-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .tab-bar {
            height: 70px; 
            padding-bottom: env(safe-area-inset-bottom); 
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            z-index: 50;
        }
        
        .tab-button.active .icon-container {
            color: #007aff; 
        }
        .tab-button:not(.active) .icon-container {
            color: #999;
        }
        .tab-button.active .tab-label {
            color: #007aff;
        }
    </style>
    <script>
        const svgIcon = (path, name) => `
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-6 w-6 transition-colors duration-150">
                ${path}
            </svg>
            <span class="tab-label text-xs mt-1 transition-colors duration-150">${name}</span>
        `;
        
        const icons = {
            home: { 
                path: '<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/>',
                name: 'Accueil'
            },
            graph: { 
                path: '<g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M19.5 19H9.5C7.29086 19 5.5 17.2091 5.5 15V5" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M15.619 7.25C15.2048 7.25 14.869 7.58579 14.869 8C14.869 8.41421 15.2048 8.75 15.619 8.75V7.25ZM19.5 8.75C19.9142 8.75 20.25 8.41421 20.25 8C20.25 7.58579 19.9142 7.25 19.5 7.25V8.75ZM20.25 8C20.25 7.58579 19.9142 7.25 19.5 7.25C19.0858 7.25 18.75 7.58579 18.75 8H20.25ZM18.75 11.607C18.75 12.0212 19.0858 12.357 19.5 12.357C19.9142 12.357 20.25 12.0212 20.25 11.607H18.75ZM20.0765 8.47973C20.3414 8.16133 20.2981 7.68844 19.9797 7.42349C19.6613 7.15855 19.1884 7.20188 18.9235 7.52027L20.0765 8.47973ZM15.5 12.807L16.0038 13.3626C16.0298 13.339 16.054 13.3137 16.0765 13.2867L15.5 12.807ZM13.931 12.868L13.4663 13.4567L13.4718 13.461L13.931 12.868ZM12.882 12.04L13.3467 11.4513L13.3429 11.4483L12.882 12.04ZM11.2 12.223L10.6226 11.7443C10.6152 11.7532 10.608 11.7623 10.601 11.7716L11.2 12.223ZM11.072 12.375L11.6074 12.9002C11.6112 12.8963 11.615 12.8923 11.6187 12.8884L11.072 12.375ZM7.83052 14.6088C7.54048 14.9046 7.54508 15.3794 7.8408 15.6694C8.13652 15.9595 8.61138 15.9549 8.90141 15.6592L7.83052 14.6088ZM15.619 8.75H19.5V7.25H15.619V8.75ZM18.75 8V11.607H20.25V8H18.75ZM18.9235 7.52027L14.9235 12.3273L16.0765 13.2867L20.0765 8.47973L18.9235 7.52027ZM14.9962 12.2514C14.8266 12.4052 14.5711 12.4151 14.3901 12.275L13.4718 13.461C14.228 14.0465 15.2953 14.005 16.0038 13.3626L14.9962 12.2514ZM14.3956 12.2793L13.3466 11.4513L12.4173 12.6287L13.4663 13.4567L14.3956 12.2793ZM13.3429 11.4483C12.5051 10.7957 11.3004 10.9268 10.6226 11.7443L11.7773 12.7017C11.9377 12.5082 12.2228 12.4772 12.4211 12.6317L13.3429 11.4483ZM10.601 11.7716C10.5774 11.8029 10.5521 11.833 10.5252 11.8616L11.6187 12.8884C11.6826 12.8203 11.7427 12.7489 11.7989 12.6744L10.601 11.7716ZM10.5365 11.8498L7.83052 14.6088L8.90141 15.6592L11.6074 12.9002L10.5365 11.8498Z" fill="#000000"></path> </g>',
                name: 'Stats'
            },
            order: { 
                path: '<g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M18 7h-3V6a3 3 0 0 0-6 0v1H6a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V8a1 1 0 0 0-1-1zm-7-1a1 1 0 0 1 2 0v1h-2V6zm6 13H7V9h2v1.5a1 1 0 0 0 2 0V9h2v1.5a1 1 0 0 0 2 0V9h2v10z"></path> </g>',
                name: 'Commandes'
            },
            catalog: { 
                path: '<g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M16 6.00008V4.2844C16 3.51587 16 3.13161 15.8387 2.88321C15.6976 2.66587 15.4776 2.5118 15.2252 2.45345C14.9366 2.38677 14.5755 2.51809 13.8532 2.78073L6.57982 5.4256C6.01064 5.63257 5.72605 5.73606 5.51615 5.91845C5.33073 6.07956 5.18772 6.28374 5.09968 6.51304C5 6.77264 5 7.07546 5 7.6811V12.0001M9 17.0001H15M9 13.5001H15M9 10.0001H15M8.2 21.0001H15.8C16.9201 21.0001 17.4802 21.0001 17.908 20.7821C18.2843 20.5903 18.5903 20.2844 18.782 19.9081C19 19.4802 19 18.9202 19 17.8001V9.20008C19 8.07997 19 7.51992 18.782 7.0921C18.5903 6.71577 18.2843 6.40981 17.908 6.21807C17.4802 6.00008 16.9201 6.00008 15.8 6.00008H8.2C7.0799 6.00008 6.51984 6.00008 6.09202 6.21807C5.71569 6.40981 5.40973 6.71577 5.21799 7.0921C5 7.51992 5 8.07997 5 9.20008V17.8001C5 18.9202 5 19.4802 5.21799 19.9081C5.40973 20.2844 5.71569 20.5903 6.09202 20.7821C6.51984 21.0001 7.07989 21.0001 8.2 21.0001Z" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g>',
                name: 'Menu'
            },
            link: {
                path: '<path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.74 1.74"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.74-1.74"/>',
                name: 'OnyLab 1'
            },
            globe: {
                path: '<circle cx="12" cy="12" r="10"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/><line x1="2.1" y1="12" x2="21.9" y2="12"/>',
                name: 'OnyLab 2'
            }
        };

        let currentTab = 1;

        const initializeChart = () => {
            const ctx = document.getElementById('userPerformanceChart');

            if (ctx && typeof Chart !== 'undefined') {
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam', 'Dim'],
                        datasets: [{
                            label: 'Commandes',
                            data: [65, 59, 80, 81, 56, 55, 40],
                            borderColor: '#007aff', 
                            backgroundColor: 'rgba(0, 122, 255, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 4,
                            pointBackgroundColor: '#007aff',
                            pointHoverRadius: 6,
                        }, {
                            label: 'Nouveaux Clients',
                            data: [15, 20, 18, 25, 22, 30, 19],
                            borderColor: '#34c759', 
                            backgroundColor: 'rgba(52, 199, 89, 0.1)',
                            fill: false,
                            tension: 0.4,
                            pointRadius: 4,
                            pointBackgroundColor: '#34c759',
                            pointHoverRadius: 6,
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false, 
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(200, 200, 200, 0.3)'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: {
                                    usePointStyle: true,
                                    padding: 20
                                }
                            },
                            tooltip: {
                                mode: 'index',
                                intersect: false,
                                backgroundColor: 'rgba(0,0,0,0.8)',
                                titleFont: { size: 14, weight: 'bold' },
                                bodyFont: { size: 12 },
                                padding: 10,
                                cornerRadius: 8
                            }
                        }
                    }
                });
            }
        };

        const showTab = (tabIndex) => {
            if (tabIndex === currentTab) return; 

            currentTab = tabIndex;

            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
                content.classList.remove('flex'); 
            });
            
            const activeContent = document.getElementById(`tab${tabIndex}-content`);
            if (activeContent) {
                activeContent.classList.remove('hidden');
                
                if (tabIndex > 1) {
                    activeContent.classList.add('flex'); 
                }
            }

            document.querySelectorAll('.tab-button').forEach(button => {
                const buttonIndex = parseInt(button.getAttribute('data-tab'));
                if (buttonIndex === tabIndex) {
                    button.classList.add('active');
                } else {
                    button.classList.remove('active');
                }
            });

            if (tabIndex === 2) {
                const iframe = document.getElementById(`iframe${tabIndex}`);
                if (iframe) {
                    iframe.src = 'http://orderline.portal.apps.onylab.com';
                    console.log(`Chargement de l'iframe pour l'onglet ${tabIndex}`);
                }
            }

            if (tabIndex === 3) {
                const iframe = document.getElementById(`iframe${tabIndex}`);
                //if (iframe && iframe.src === '') {
                if (iframe) {
                    iframe.src = 'https://manager.portal.apps.onylab.com/dashboard';
                    console.log(`Chargement de l'iframe pour l'onglet ${tabIndex}`);
                }
            }

            if (tabIndex === 4) {
                const iframe = document.getElementById(`iframe${tabIndex}`);
                if (iframe) {
                    iframe.src = 'http://catalog.portal.apps.onylab.com';
                    console.log(`Chargement de l'iframe pour l'onglet ${tabIndex}`);
                }
            }
        };

        window.onload = () => {
            document.getElementById('btn-home').innerHTML = svgIcon(icons.home.path, icons.home.name);
            document.getElementById('btn-link1').innerHTML = svgIcon(icons.order.path, icons.order.name);
            document.getElementById('btn-link2').innerHTML = svgIcon(icons.graph.path, icons.graph.name);
            document.getElementById('btn-link3').innerHTML = svgIcon(icons.catalog.path, icons.catalog.name);

            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', () => {
                    const tabIndex = parseInt(button.getAttribute('data-tab'));
                    showTab(tabIndex);
                });
            });

            initializeChart();

            showTab(1);
        };
    </script>
</head>
<body>
    
    <div class="content-container bg-gray-50 flex-1 relative">

        <div id="tab1-content" class="tab-content h-full p-4 md:p-8 overflow-y-auto">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-900 mb-6">Tableau de bord</h1>
            <p class="text-lg text-gray-600 mb-8">Bienvenue dans votre interface de gestion simplifiée.</p>
            
            <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-100 mb-8">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Performance (7 derniers jours)</h2>
                <div class="relative h-64">
                    <canvas id="userPerformanceChart"></canvas>
                </div>
            </div>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                
                <div class="bg-white p-5 rounded-xl shadow-lg border border-gray-100 transform hover:scale-[1.02] transition duration-200 cursor-pointer">
                    <div class="flex items-center space-x-3">
                        <span class="p-3 rounded-full bg-blue-100 text-blue-600">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c1.657 0 3 .895 3 2s-1.343 2-3 2-3-.895-3-2 1.343-2 3-2zM12 21c-4.418 0-8-3.582-8-8 0-4.418 3.582-8 8-8s8 3.582 8 8c0 4.418-3.582 8-8 8z"/></svg>
                        </span>
                        <p class="text-sm font-medium text-gray-500">Statut des services</p>
                    </div>
                    <p class="text-3xl font-bold text-gray-800 mt-2">Opérationnel</p>
                    <p class="text-xs text-green-500 mt-1">Tous les systèmes sont fonctionnels.</p>
                </div>

                <div class="bg-white p-5 rounded-xl shadow-lg border border-gray-100 transform hover:scale-[1.02] transition duration-200 cursor-pointer">
                    <div class="flex items-center space-x-3">
                        <span class="p-3 rounded-full bg-yellow-100 text-yellow-600">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1z"/></svg>
                        </span>
                        <p class="text-sm font-medium text-gray-500">Clients actifs</p>
                    </div>
                    <p class="text-3xl font-bold text-gray-800 mt-2">1,245</p>
                    <p class="text-xs text-red-500 mt-1">-5% par rapport à hier.</p>
                </div>
                
                <div class="bg-white p-5 rounded-xl shadow-lg border border-gray-100 transform hover:scale-[1.02] transition duration-200 cursor-pointer">
                    <div class="flex items-center space-x-3">
                        <span class="p-3 rounded-full bg-red-100 text-red-600">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
                        </span>
                        <p class="text-sm font-medium text-gray-500">Taux de conversion</p>
                    </div>
                    <p class="text-3xl font-bold text-gray-800 mt-2">4.7%</p>
                    <p class="text-xs text-green-500 mt-1">+0.3% ce mois-ci.</p>
                </div>
            </div>
        </div>

        <div id="tab2-content" class="tab-content hidden h-full">
            <div class="iframe-container">
                <iframe id="iframe2" src="" loading="lazy"></iframe>
            </div>
            <div class="absolute inset-0 bg-white/90 flex items-center justify-center p-4 text-center text-sm text-red-600 opacity-0 transition duration-500" style="pointer-events: none;">
                <p>L'iframe 1 peut ne pas s'afficher si onylab.com bloque l'intégration externe.</p>
            </div>
        </div>

        <div id="tab3-content" class="tab-content hidden h-full">
            <div class="iframe-container">
                <iframe id="iframe3" src="" loading="lazy"></iframe>
            </div>
            <div class="absolute inset-0 bg-white/90 flex items-center justify-center p-4 text-center text-sm text-red-600 opacity-0 transition duration-500" style="pointer-events: none;">
                <p>L'iframe 2 peut ne pas s'afficher si onylab.com bloque l'intégration externe.</p>
            </div>
        </div>

        <div id="tab4-content" class="tab-content hidden h-full">
            <div class="iframe-container">
                <iframe id="iframe4" src="" loading="lazy"></iframe>
            </div>
            <div class="absolute inset-0 bg-white/90 flex items-center justify-center p-4 text-center text-sm text-red-600 opacity-0 transition duration-500" style="pointer-events: none;">
                <p>L'iframe 3 peut ne pas s'afficher si onylab.com bloque l'intégration externe.</p>
            </div>
        </div>
    </div>
    
    <nav class="fixed bottom-0 left-0 right-0 bg-white tab-bar">
        <div class="flex h-full justify-around items-start pt-2">

            <button id="btn-home" data-tab="1" class="tab-button active flex flex-col items-center justify-center w-1/4 h-full text-gray-900 focus:outline-none">
                <div class="icon-container flex flex-col items-center">
                </div>
            </button>

            <button id="btn-link1" data-tab="2" class="tab-button flex flex-col items-center justify-center w-1/4 h-full text-gray-900 focus:outline-none">
                <div class="icon-container flex flex-col items-center">
                </div>
            </button>

            <button id="btn-link2" data-tab="3" class="tab-button flex flex-col items-center justify-center w-1/4 h-full text-gray-900 focus:outline-none">
                <div class="icon-container flex flex-col items-center">
                </div>
            </button>

            <button id="btn-link3" data-tab="4" class="tab-button flex flex-col items-center justify-center w-1/4 h-full text-gray-900 focus:outline-none">
                <div class="icon-container flex flex-col items-center">
                </div>
            </button>
        </div>
    </nav>

</body>
</html>